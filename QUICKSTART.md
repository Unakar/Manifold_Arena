# Quick Start Guide: Spectral Ball vs Manifold Muon

## ğŸš€ å¿«é€Ÿå¼€å§‹

### è¿è¡Œå­¦ä¹ ç‡æ‰«æå®éªŒ

è¿™æ˜¯æœ€æ¨èçš„æ–¹å¼ï¼Œå¯ä»¥ä¸€æ¬¡æ€§å¯¹æ¯”ä¸¤ç§ä¼˜åŒ–å™¨åœ¨ä¸åŒå­¦ä¹ ç‡ä¸‹çš„è¡¨ç°ã€‚

```bash
# 1. è¿è¡Œå­¦ä¹ ç‡æ‰«æ (æ‰«æ lr = 0.001, 0.01, 0.1, 1.0)
chmod +x lr_sweep.sh
./lr_sweep.sh --epochs 10 --seed 42

# 2. ç”Ÿæˆå¯¹æ¯”å›¾è¡¨ (æ¨ªåæ ‡: å­¦ä¹ ç‡, çºµåæ ‡: æµ‹è¯•å‡†ç¡®ç‡)
python plot_lr_sweep.py --seed 42 --output lr_sweep.png

# 3. æŸ¥çœ‹ç»“æœè¡¨æ ¼
python plot_lr_sweep.py --seed 42 --no-plot
```

### è¾“å‡ºç¤ºä¾‹

**è¡¨æ ¼è¾“å‡º:**
```
======================================================================
Learning Rate Sweep Results Summary
======================================================================
Learning Rate   Manifold Muon        Spectral Ball        Difference
----------------------------------------------------------------------
0.0010          45.23%               44.87%               -0.36%
0.0100          52.15%               51.89%               -0.26%
0.1000          54.32%               54.78%               +0.46%
1.0000          48.76%               49.12%               +0.36%
======================================================================

Best Manifold Muon: 54.32% at lr=0.1
Best Spectral Ball: 54.78% at lr=0.1
```

**ç”Ÿæˆçš„å›¾è¡¨:**
- æ¨ªåæ ‡: å­¦ä¹ ç‡ (å¯¹æ•°åˆ»åº¦)
- çºµåæ ‡: æµ‹è¯•å‡†ç¡®ç‡ (%)
- ä¸¤æ¡æ›²çº¿åˆ†åˆ«ä»£è¡¨ Manifold Muon å’Œ Spectral Ball
- è‡ªåŠ¨æ ‡æ³¨æœ€ä½³å­¦ä¹ ç‡å’Œå¯¹åº”å‡†ç¡®ç‡

---

## ğŸ“Š è‡ªå®šä¹‰å­¦ä¹ ç‡èŒƒå›´

å¦‚æœéœ€è¦ä¿®æ”¹å­¦ä¹ ç‡æ‰«æèŒƒå›´ï¼Œç¼–è¾‘ `lr_sweep.sh`:

```bash
# ä¿®æ”¹ç¬¬ 11 è¡Œ
LR_VALUES=(0.001 0.01 0.1 1.0)

# æ”¹ä¸ºä½ æƒ³è¦çš„å€¼ï¼Œä¾‹å¦‚:
LR_VALUES=(0.005 0.01 0.05 0.1 0.5)
```

---

## ğŸ” å•ä¸ªå­¦ä¹ ç‡å¯¹æ¯”

å¦‚æœåªæƒ³æµ‹è¯•æŸä¸ªç‰¹å®šå­¦ä¹ ç‡:

```bash
cd src

# Manifold Muon
python main.py --update manifold_muon --epochs 10 --lr 0.1 --seed 42

# Spectral Ball
python main.py --update spectral_ball --epochs 10 --lr 0.1 --seed 42
```

---

## ğŸ“ˆ é¢„æœŸç»“æœ

åœ¨ CIFAR-10 ä¸Šä½¿ç”¨ç®€å• MLP:

| ä¼˜åŒ–å™¨ | æœ€ä½³å­¦ä¹ ç‡ | æµ‹è¯•å‡†ç¡®ç‡ | ç‰¹ç‚¹ |
|--------|-----------|-----------|------|
| **Manifold Muon** | ~0.1 | ~54% | æ‰€æœ‰å¥‡å¼‚å€¼ â‰ˆ 1 (æ­£äº¤) |
| **Spectral Ball** | ~0.1 | ~54% | ä»…çº¦æŸæœ€å¤§å¥‡å¼‚å€¼ |
| AdamW | ~0.001 | ~50% | æ— çº¦æŸ |

**å…³é”®å‘ç°:**
1. ä¸¤ç§æµå½¢ä¼˜åŒ–å™¨æ€§èƒ½æ¥è¿‘
2. Spectral Ball å¯èƒ½åœ¨æŸäº›å­¦ä¹ ç‡ä¸‹ç•¥ä¼˜
3. æµå½¢çº¦æŸæä¾›äº†éšå¼æ­£åˆ™åŒ–
4. å­¦ä¹ ç‡èŒƒå›´æ¯” AdamW å¤§ (0.1 vs 0.001)

---

## ğŸ’¡ è°ƒä¼˜å»ºè®®

### å­¦ä¹ ç‡é€‰æ‹©
- **èµ·ç‚¹**: lr=0.1
- **æ‰«æèŒƒå›´**: [0.01, 0.1, 1.0]
- **ç²¾ç»†æœç´¢**: åœ¨æœ€ä½³ç‚¹é™„è¿‘å†ç»†åˆ†

### Epochs
- **å¿«é€Ÿæµ‹è¯•**: 5 epochs
- **å®Œæ•´è®­ç»ƒ**: 20-50 epochs

### å…¶ä»–è¶…å‚æ•°
åœ¨ `src/spectral_ball.py` ä¸­:
```python
power_iter_steps = 50      # Power iteration æ­¥æ•°
msign_steps = 10           # Matrix sign è¿­ä»£æ­¥æ•°
lambda_tolerance = 1e-6    # Î» æ±‚è§£å™¨æ”¶æ•›å®¹å·®
```

---

## ğŸ› ï¸ æ•…éšœæ’é™¤

### CUDA å†…å­˜ä¸è¶³
```bash
# åœ¨ src/main.py ä¸­å‡å° batch size
train_loader = DataLoader(..., batch_size=512, ...)  # åŸæ¥æ˜¯ 1024
```

### æ”¶æ•›æ…¢/ç²¾åº¦ä½
```python
# åœ¨ src/spectral_ball.py ä¸­å¢åŠ è¿­ä»£æ­¥æ•°
power_iter_steps = 100  # åŸæ¥æ˜¯ 50
msign_steps = 15        # åŸæ¥æ˜¯ 10
```

### è®­ç»ƒä¸ç¨³å®š
- é™ä½å­¦ä¹ ç‡
- æ£€æŸ¥æ¢¯åº¦èŒƒæ•° (åœ¨ main.py ä¸­æ·»åŠ æ‰“å°)
- å¢åŠ æ•°å€¼ç¨³å®šæ€§å¸¸æ•° (eps)

---

## ğŸ“ æ–‡ä»¶è¯´æ˜

- `lr_sweep.sh` - å­¦ä¹ ç‡æ‰«æè„šæœ¬
- `plot_lr_sweep.py` - ç»˜å›¾å’Œç»“æœåˆ†æ
- `src/spectral_ball.py` - Spectral Ball å®ç°
- `src/manifold_muon.py` - Manifold Muon å®ç°
- `src/main.py` - è®­ç»ƒä¸»ç¨‹åº
- `src/results/` - å®éªŒç»“æœå­˜å‚¨ç›®å½•

---

## ğŸ“š æ›´å¤šä¿¡æ¯

è¯¦ç»†æ–‡æ¡£è¯·æŸ¥çœ‹: `SPECTRAL_BALL_README.md`
